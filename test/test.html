<html> 
<head> 
  <title>jquery-wakeful test</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" /> 
  <script src="jquery-1.6.2.min.js"></script>

  <script src="qunit-75dae0b/qunit.js"></script>
  <link rel="stylesheet" href="qunit-75dae0b/qunit.css" type="text/css" />

  <script src="../jquery-wakeful.js"></script>

  <script>
    var api = $.Wakeful({
      baseUrl: "http://localhost:4513/echo/"
    });

    function log() {
      var args = Array.prototype.slice.call(arguments);
      var cur = QUnit.config.current? QUnit.config.current.testName : "<none>";
      args.splice(0, 0, cur + ":");
      console.log.apply(console, args);
    }

    function asyncFail(reason) {
      return function() {
        start();
        log("asyncFail arguments:", arguments);
        ok(false, reason || "asyncFail (see console.log)");
      }
    }

    $(document).ready(function() {
      $.each([
        ["get(args, kwargs)", [["arg"], {kw: "kwval"}], {0: "arg", kw: "kwval"}],
        ["get(args)", [["arg"]], {0: "arg"}],
        ["get(kwargs)", [{kw: "kwval"}], {kw: "kwval"}],
        ["get()", [], {}]
      ], function() {
        var args = this[1];
        var expected = this[2];
        args.splice(0, 0, "foo");
        args.push(function(result) {
          start();
          deepEqual(result, expected);
        });
        args.push(asyncFail());
        asyncTest(this[0], function() {
          api.get.apply(api, args);
        });
      });
    });
  </script>

</head>

<body>
  <h1 id="qunit-header">jquery-wakeful tests</h1>
  <h2 id="qunit-banner"></h2>
  <div id="qunit-testrunner-toolbar"></div>
  <h2 id="qunit-userAgent"></h2>
  <ol id="qunit-tests"></ol>
</body>
</html>

